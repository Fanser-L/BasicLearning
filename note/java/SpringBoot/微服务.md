# 微服务

#### 什么是微服务？

微服务，又叫微服务架构，是一种软件架构方式。它将应用构建成一系列按业务领域划分模块的、小的自治服务。

在微服务架构中，每个服务都是自我包含的，并且实现了单一的业务功能。

#### 有哪些服务架构呢？（分布式架构的发展演变）

从我们开始学习到现在，最早接触的应该是单应用服务架构，然后是MVC服务架构，再到后来RPC，然后到SOA

![img](https://s2.loli.net/2022/03/31/hGb7Oa3KoxMqVvr.png)

从图上就能看出来，起初的建设项目方式非常的臃肿，而且不能够多布置几个在服务器上就差不多承受不住了，而现今的架构却能承受原本上千万倍的应用。所以说这就是越来越多的企业，为什么选择了使用微服务架构来进行一个整合以满足大量客户的期望。

还是从0开始聊起，从最早的架构方式聊起

#### 单体应用架构

所谓单体应用架构（all in one） 是指，我们将一个应用中的所有应用服务都封装在一个应用中（单页面完成全部的内容）。

无论是ERP，CRM或者说其他的系统，都把数据库访问，web访问等等各个功能都放到一个war包内。

- 这样的好处是，易于开发和测试；也十分方便部署；当我们需要拓展时，只需要将war复制多份，然后放到多个服务器上，然后做个负载均衡即可。
- 单体应用的缺点是，哪怕我要修改一个非常小的地方，我都需要停掉整个服务，重新打包，部署整个应用war包。特别是对于一个大型的应用，我们不可能把所有的内容都放到同一个应用里面，我们如何维护，如何分工都是问题。

#### 垂直应用架构

当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，将应用拆成互不相干的几个应用，以提升效率。此时，用于加速前端页面开发的Web框架(MVC)是关键。

![img](https://s2.loli.net/2022/03/31/YVPzoFE6BdT2AQS.png)

通过切分业务来实现各个模块独立部署，降低了维护和部署的难度，团队各司其职更易管理，性能扩展也更方便，更有针对性。

缺点： 公用模块无法重复利用，开发性的浪费

#### 分布式服务架构

当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的**分布式服务框架(RPC)**是关键。

![img](https://s2.loli.net/2022/03/31/9NlJ8aOSTz6gCVD.png)

#### 流动计算架构

当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。此时，用于**提高机器利用率的资源调度和治理中心(SOA)[ Service Oriented Architecture]**是关键。

#### 微服务架构

把每个功能独立出来，把所有的独立出来的功能元素独立出来动态组合，需要的功能元素才拿来组合，需要多一些是可以整合多个功能元素。所以说微服务架构是对功能元素进行复制，而没有对整个应用进行复制。

优点：

- 节省了调用资源
- 每个元素的服务都是可替换的，可以独立升级的软件代码

简单来说，将一个系统按业务划分成多个子系统，每个子系统都是完整的，可独立运行的，子系统间的交互可通过HTTP协议进行通信（也可以采用消息队列来通信，如RocketMQ，Kafaka等）

所以说，不同的子系统可以使用不同的编程语言实现，使用的不同的存储技术。

但是，因为子系统服务数量越多，管理起来越复杂，因此需要采用集中化管理，如Eureka，Zookeeper等都是比较常见的服务集中化管理框架；同时，使用自动化部署（如Jenkins）减少人为控制，降低出错概率，提高效率。（不知所云）

