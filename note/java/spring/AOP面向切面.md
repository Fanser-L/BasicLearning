## AOP面向切面

> AOP（Aspect Oriented Programming）意为：面向切面编程，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。

![image-20220228181258207](C:\Users\86159\AppData\Roaming\Typora\typora-user-images\image-20220228181258207.png)

### 代理模式

> 为什么要学习代理模式，因为代理模式就是AOP 的底层机制。

代理模式分为静态代理和动态代理两种

- **静态代理**
- **动态代理**

#### 静态代理

**静态代理角色分析**

- 抽象角色 : 一般使用接口或者抽象类来实现
- 真实角色 : 被代理的角色
- 代理角色 : 代理真实角色 ; 代理真实角色后 , 一般会做一些附属的操作 .
- 客户 : 使用代理角色来进行一些操作 .

举个例子： 

	现在我们模拟租房的流程。
	房东：我需要把房子租出去；
	客户：我需要租个房子；
	
	为了方便双方达成目的，所以我们需要中介来更好的完成这件事。
	
	中介：（1）给客户提供需要的房子（2）把房东的房子租出去（3）获取自己的利益（增值业务）

**静态代理的好处:**

- 可以使得我们的真实角色更加纯粹 . 不再去关注一些公共的事情 .
- 公共的业务由代理来完成 . 实现了业务的分工 ,
- 公共业务发生扩展时变得更加集中和方便 .

缺点 :

- 类多了 , 多了代理类 , 工作量变大了 . 开发效率降低 .

我们想要静态代理的好处，又不想要静态代理的缺点，所以 , 就有了动态代理 !

#### 动态代理

**动态代理**

- 动态代理的角色和静态代理的一样 .
- 动态代理的代理类是动态生成的 . 静态代理的代理类是我们提前写好的
- 动态代理分为两类 : 一类是基于接口动态代理 , 一类是基于类的动态代理
- - 基于接口的动态代理----JDK动态代理
  - 基于类的动态代理–cglib
  - 现在用的比较多的是 javasist 来生成动态代理 . 百度一下javasist
  - 我们这里使用JDK的原生代码来实现，其余的道理都是一样的！、

**JDK的动态代理需要了解两个类**

核心 : InvocationHandler 和 Proxy ， 打开JDK帮助文档看看



#### AOP在spring中是干嘛的？

提供声明式事务：允许用户自定义切面

一些在AOP中的名词：

- 横切关注点：跨越应用程序多个模块的方法或功能。即是，与我们业务逻辑无关的，但是我们需要关注的部分，就是横切关注点。如日志 , 安全 , 缓存 , 事务等等 …

- 切面（ASPECT）：横切关注点  被模块化的特殊对象，即 它是一个类
- 通知（Advice）：切面必须完成的工作。即，它是类中的一个方法
- 目标（Target）：被通知对象
- 代理（Proxy）：向目标对象应用通知之后创建的对象
- 切入点（PointCut）：切面通知执行的地点的定义
- 连接点（JoinPoint）：与切入点相匹配的执行点

![image-20220228182037855](C:\Users\86159\AppData\Roaming\Typora\typora-user-images\image-20220228182037855.png)

